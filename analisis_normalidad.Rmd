---
title: "Análisis de Normalidad"
author: "Paúl Arévalo, Esteban Vizhñay"
date: "2024-07-03"
output: pdf_document
---

El analisis de la normalidad es importante para analizar cuanto difiere nuestra distribución si esta proviene de una distribucion normal con una media y desviacion estandar iguales. Existen cuatro estrategias para comprobar la normalidad

# Métodos Gráficos

Para estas demostraciones se creará una distribución randomica:

```{r}
set.seed(12345)
x <- rnorm(n=200, mean=15, sd=5)
x
```

## Histograma de frencuencias

```{r}
h = hist(x, main="Histograma de datos con distribución normal", xlab = "Datos aleatorios", ylab = "Frecuencia", probability = TRUE)
x2 <- seq(min(x), max(x), length = 50)
normal <- dnorm(x2, mean = mean(x), sd = sd(x))
lines(x2, normal, col = 2, lwd = 2)
lines(density(x), col = 4, lwd = 2)
```

## Gráfico de cuantiles teóricos (Gráfico Q-Q)

```{r}
qqnorm(x, main = "Gráfico Q-Q Normal", xlab = "Cuantiles Teóricos", ylab = "Cuantiles de muestra", pch = 20, col = "blue")
qqline(x)
```

## Diagrama de Caja

```{r}
boxplot(x)
```

# Métodos Analíticos

## Asimetria

Existen tres tipos de asimetría

![](https://www.biologyforlife.com/uploads/2/2/3/9/22392738/c101b0da6ea1a0dab31f80d9963b0368_orig.png){width="635"}

Para el analisis del mismo vamos a definir los siguientes rangos:

-   El valor se encuentra entre -0.5 y 0.5. La distribución es aproximadamente sesgada.

-   El valor se encuentra entre -1 a -5 o 1 a 5. La distribución es ligeramente sesgada.

-   El valor es menor que -1 o mayor a 1. La distribución es moderadamente sesgada pero aceptable.

-   Si el valor supera -2 o 2. La distribución no es normal

```{r}
dist_norm_as =rnorm(n=450, mean=2, sd=2.3)
dist_gamma_as =  rgamma(n=450, shape=2, scale=3)
```

```{r}
# Configurar la disposición de los gráficos
par(mfrow = c(1, 2))

# Dibujar el primer histograma
hist(dist_norm_as, main = "Normal", col = "blue")

# Dibujar el segundo histograma
hist(dist_gamma_as, main = "Binomial", col = "red")

```

```{r}
print(skewness(dist_norm_as))
print(skewness(dist_gamma_as))
```

## Curtosis

Permite medir el grado de apuntamiento o achatamiento de la distribución de frecuencia, respecto a la curva de la distribución normal que tiene coeficiente igual a 0.

![](images/download (1).png)

```{r}
print(kurtosis(dist_norm_as))
print(kurtosis(dist_gamma_as))
```

# Contraste de hipótesis

```{r}
library('nortest')
```

En todas las pruebas a realizar se considera como hipótesis nula que los datos sí proceden de una distribución normal y como hipótesis alternativa que no lo hacen. El *p-value* de estos test indica la probabilidad de obtener una distribución como la observada si los datos proceden realmente de una población con una distribución normal.

***El nivel de significancia es 0.05***

## Prueba de Shapiro-Wilk

La muestra debe ser menor a 50 datos.

```{r}
dist_norm_sw =rnorm(n=49, mean=15, sd=5)
dist_binm_sw = rnbinom(n=49, size=5, prob=0.35)
```

```{r}
# Configurar la disposición de los gráficos
par(mfrow = c(1, 2))

# Dibujar el primer histograma
hist(dist_norm_sw, main = "Normal", col = "blue")

# Dibujar el segundo histograma
hist(dist_binm_sw, main = "Binomial", col = "red")

```

```{r}
print(shapiro.test(x = dist_norm_sw))
print(shapiro.test(x = dist_binm_sw))
```

## Prueba de Anderson-Darling

El número de muestras tiene que ser mayor a 7

```{r}
dist_norm_ad =rnorm(n=85, mean=15, sd=5)
dist_binm_ad = rnbinom(n=76, size=5, prob=0.35)
```

```{r}
# Configurar la disposición de los gráficos
par(mfrow = c(1, 2))

# Dibujar el primer histograma
hist(dist_norm_ad, main = "Normal", col = "blue")

# Dibujar el segundo histograma
hist(dist_binm_ad, main = "Binomial", col = "red")
```

```{r}
print(shapiro.test(x = dist_norm_ad))
print(shapiro.test(x = dist_binm_ad))
```

## Prueba de Cramer-von Mises

Útil para muestras pequeñas

```{r}
dist_norm_cm =rnorm(n=49, mean=15, sd=5)
dist_gamm_cm = rgamma(n=49, shape=2, scale=3)
```

```{r}
# Configurar la disposición de los gráficos
par(mfrow = c(1, 2))

# Dibujar el primer histograma
hist(dist_norm_cm, main = "Normal", col = "blue")

# Dibujar el segundo histograma
hist(dist_gamm_cm, main = "Gamma", col = "red")
```

```{r}
print(cvm.test(x = dist_norm_cm))
print(cvm.test(x = dist_gamm_cm))
```

## Prueba Lilliefors

Número de observaciones mayor a 50

```{r}
dist_norm_li =rnorm(n=320, mean=15, sd=5)
dist_gamm_li = rgamma(n=320, shape=2, scale=3)

```

```{r}
# Configurar la disposición de los gráficos
par(mfrow = c(1, 2))

# Dibujar el primer histograma
hist(dist_norm_li, main = "Normal", col = "blue")

# Dibujar el segundo histograma
hist(dist_gamm_li, main = "Gamma", col = "red")
```

```{r}
print(lillie.test(x = dist_norm_li))
print(lillie.test(x = dist_gamm_li))
```

## Prueba Pearson chi-square

Basa en una distribución Chi Cuadrada

```{r}
dist_norm_pcq =rnorm(n=410, mean=15, sd=5)
dist_gamm_pcq = rgamma(n=410, shape=2, scale=3)
```

```{r}
# Configurar la disposición de los gráficos
par(mfrow = c(1, 2))

# Dibujar el primer histograma
hist(dist_norm_pcq, main = "Normal", col = "blue")

# Dibujar el segundo histograma
hist(dist_gamm_pcq, main = "Gamma", col = "red")
```

```{r}
print(pearson.test(x = dist_norm_pcq))
print(pearson.test(x = dist_gamm_pcq))
```
